<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>

    <style>
      label {
        display: inline-block;
        font-size: 16px;
        font-family: Arial, Helvetica, sans-serif;
        width: 110px;
      }

      input,
      select {
        width: 180px;
        height: 30px;
        font-size: 16px;
        font-family: Arial, Helvetica, sans-serif;
      }

      button {
        height: 30px;
        width: 72px;
      }
    </style>
  </head>
  <body>
    <label>First Name</label>
    <input type="text" id="FnameInp" />
    <br /><br />

    <label>Last Name</label>
    <input type="text" id="LnameInp" />
    <br /><br />

    <label>Department</label>
    <select id="DeptInp">
      <option value="Development">Development</option>
      <option value="Testing">Testing</option>
      <option value="Management">Management</option>
      <option value="Administration">Administration</option>
    </select>
    <br /><br />

    <label>Can Swim</label>
    <select id="swimId">
      <option value="yes">Yes</option>
      <option value="no">No</option>
    </select>
    <br /><br />

    <label>Id</label>
    <input type="number" id="cnicId" />
    <br /><br />

    <button id="addBtn">Add</button>
    <button id="retBtn">Retrieve</button>
    <button id="updBtn">Update</button>
    <button id="delBtn">Delete</button>

    <script type="module">
    
      import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-app.js";
  
      const firebaseConfig = {
        apiKey: "AIzaSyCTafrGKJdYeKPZ-nolIWFPAXHW_zGNfPw",
        authDomain: "test2-654cc.firebaseapp.com",
        databaseURL: "https://test2-654cc-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "test2-654cc",
        storageBucket: "test2-654cc.appspot.com",
        messagingSenderId: "8146446019",
        appId: "1:8146446019:web:29f508ea164204f108e476"
      };

      const app = initializeApp(firebaseConfig);

      import { getDatabase, ref, child, get, set, update, remove } from "https://www.gstatic.com/firebasejs/10.12.3/firebase-database.js";

      const db = getDatabase();

      let FnameInp = document.getElementById('FnameInp');
      let LnameInp = document.getElementById('LnameInp');
      let DeptInp = document.getElementById('DeptInp');
      let swimId = document.getElementById('swimId');
      let cnicId = document.getElementById('cnicId');
      
      let addBtn = document.getElementById('addBtn');
      let retBtn = document.getElementById('retBtn');
      let updBtn = document.getElementById('updBtn');
      let delBtn = document.getElementById('delBtn');

      async function addData() {
        try {
          await set(ref(db, 'tasks/' + cnicId.value), {
            nameofemployee: { firstname: FnameInp.value, lastname: LnameInp.value },
            department: DeptInp.value,
            canswim: (swimId.value == "yes"),
            cnic: Number(cnicId.value)
          });
          alert('Data Added Successfully');
        } catch (error) {
          alert('Unsuccessful');
          console.log(error);
        }
      }

      async function retData() {
        const dbRef = ref(db);
        try {
          const snapshot = await get(child(dbRef, 'EmployeeSet/' + cnicId.value));
          if (snapshot.exists()) {
            FnameInp.value = snapshot.val().nameofemployee.firstname;
            LnameInp.value = snapshot.val().nameofemployee.lastname;
            DeptInp.value = snapshot.val().department;
            swimId.value = snapshot.val().canswim ? "yes" : "no";
          } else {
            alert("Employee does not exist");
          }
        } catch (error) {
          alert('Unsuccessful');
          console.log(error);
        }
      }

      async function updateData() {
        try {
          await update(ref(db, 'EmployeeSet/' + cnicId.value), {
            nameofemployee: { firstname: FnameInp.value, lastname: LnameInp.value },
            department: DeptInp.value,
            canswim: (swimId.value == "yes"),
          });
          alert('Data Updated Successfully');
        } catch (error) {
          alert('Unsuccessful');
          console.log(error);
        }
      }

      async function deleteData() {
        try {
          await remove(ref(db, 'EmployeeSet/' + cnicId.value));
          alert('Data Deleted Successfully');
        } catch (error) {
          alert('Unsuccessful');
          console.log(error);
        }
      }

      addBtn.addEventListener('click', addData);
      retBtn.addEventListener('click', retData);
      updBtn.addEventListener('click', updateData);
      delBtn.addEventListener('click', deleteData);

    </script>
  </body>
</html>
